---
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import BlogCard from "../../components/BlogCard.astro";

type Blog = CollectionEntry<"blog">;
const allBlogPosts = (
    await getCollection("blog", ({ data }) => {
        return data.unlisted == false;
    })
).sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf());
---

<style>
    ol {
        width: 50%;
        height: 50%;
        padding: 2em 0;
        margin: 0;
        flex: 1;
        display: flex;
        flex-direction: column;
        counter-reset: blog-counter;
    }

    ol li {
        display: flex;
        align-items: baseline;
        gap: 0.75em;
    }

    ol li::before {
        display: none;
    }

    .num {
        font-size: var(--title-font-size, 1.25rem);
        font-weight: bold;
        color: var(--accent-2);
        line-height: 1;
        min-width: 2ch;
        flex-shrink: 0;
    }

    ol li a,
    ol li a.active {
        text-decoration: none;
        display: block;
        min-height: 120px;
        flex: 1;
    }

    ol li a + a {
        border-top: 1px solid
            color-mix(in oklab, var(--accent-2) 30%, transparent);
    }

    @media (max-width: 768px) {
        ol {
            width: 90%;
            margin: 0 auto;
            padding: 1rem 0;
        }
    }
</style>

<Layout>
    <ol>
        {
            allBlogPosts.map((blog: Blog, index: number) => {
                return (
                    <li>
                        <span class="num">{index + 1}.</span>
                        <a href={`/blog/${blog.id}`}>
                            <BlogCard blog_data={blog.data} />
                        </a>
                    </li>
                );
            })
        }
    </ol>
</Layout>
